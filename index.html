<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>登录-上福数据</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/16.4.1/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/16.4.1/umd/react-dom.production.min.js"></script>

    <script src="https://unpkg.com/babel-standalone@6.15.0/babel.min.js"></script>
    <script src="./js/anime.min.js"></script>
    <link rel="stylesheet" type="text/css" href="./css/index.css"/>
    <meta id="eqMobileViewport" name="viewport" content="width=320, initial-scale=1, maximum-scale=1, user-scalable=no">
</head>
<script type="text/javascript">
    (function (doc, win) {
        var docEl = doc.documentElement,
            // orientationchange 事件是在用户水平或者垂直翻转设备（即方向发生变化）时触发的事件。
            // onresize 事件会在窗口或框架被调整大小时发生。
            resizeEvt = 'orientationchange' in window ? 'orientationchange' : 'resize',
            recalc = function () {
                window.clientWidth = docEl.clientWidth;
                if (!window.clientWidth) return;
                docEl.style.fontSize = 40 * (window.clientWidth / 640) + 'px';
                window.base = 40 * (window.clientWidth / 640);
            };
        if (!doc.addEventListener) return;
        win.addEventListener(resizeEvt, recalc, false);

        doc.addEventListener('DOMContentLoaded', recalc, false);
    })(document, window);
</script>
<body>
<main>
    <section class="background"></section>
    <section class="floatBox"
             id="content"
    >
    </section>
</main>
<script type="text/babel">
    class Form extends React.Component {
        renderFormItem(config) {
            return config.map((values, index) => {
                const {label, type, name, placeholder, after, ...other} = values;
                return (
                    <section key={index}>
                        <label>{`${label}:`}</label>
                        <input type={type}
                               name={name}
                               placeholder={placeholder}
                               required="required"
                               {...other}
                        />
                        {after}
                    </section>
                )
            });
        }

        render() {
            const {config, ...props} = this.props;
            return (
                <form className="form"
                      {...props}
                >
                    {this.renderFormItem(config)}
                    {this.props.children}
                    <button className="submitBtn">登录</button>
                </form>
            )
        }
    }

    class FormContainer extends React.Component {
        // constructor(props) {
        //     super(props);
        //     this.backLogin = this.backLogin.bind(this);
        // }

        animationTranslate(target, numberX) {
            anime({
                targets: target,
                translateX: numberX
            });
        }
        /**
         * 封装跳转
         */
        combinationJump(start) {
            this.animationTranslate('#login', -550);
            this.animationTranslate(start, 550);
        }


        /**
         * 返回登陆
         */
        backLogin(formId) {
            console.log(formId);
            this.animationTranslate('#login', 0);
            this.animationTranslate(`#${formId}`, 0);
        }

        /**
         * 跳转注册
         */
        goToRegister() {
            this.combinationJump('#register');
        }

        /**
         * 跳转重置密码
         */
        goToResetPassword() {
            this.combinationJump('#resetPassword');
        }

        render() {
            const {id, classname, config, title = '', ...other} = this.props;
            return (
                <aside className={classname}
                       id={id}
                >
                    <h1 className="logo">{`${title}上福数据`}</h1>
                    <p className="descr">上福数据 是金融圈最具影响力的 技术服务供应商</p>
                    <Form config={config}
                          {...other}
                    >
                        {
                            id === 'login' && (
                                <p className="service">
                                    <a href="javascript:void(0);"
                                       onClick={this.goToRegister.bind(this)}
                                    >注册账户</a>
                                    <a href="javascript:void(0);"
                                       onClick={this.goToResetPassword.bind(this)}
                                    >忘记密码</a>
                                </p>
                            ) || (
                                <section className="backButton"
                                         onClick={() => this.backLogin(id).bind(this)}
                                >
                                    <span className="backImg"/>
                                    <span className="backTitle">返回登录</span>
                                </section>
                            )
                        }
                    </Form>
                </aside>
            );
        }
    }

    class Content extends React.Component {
        render() {
            // 登陆config
            const loginConfig = [{
                label: '用户名',
                type: 'text',
                name: 'name',
                placeholder: '邮箱/手机号'
            }, {
                label: '密码',
                type: 'password',
                name: 'password'
            }];
            // 注册 重置密码config
            const registerConfig = [{
                label: '用户名',
                type: 'text',
                name: 'name',
                placeholder: '邮箱/手机号'
            }, {
                label: '密码',
                type: 'password',
                name: 'password'
            }, {
                label: '验证码',
                type: 'verification',
                name: 'verification',
                after: (
                    <button className="verificationButton">发送验证码</button>
                )
            }];
            return (
                <React.Fragment>
                    <FormContainer id="login"
                                   classname="login"
                                   config={loginConfig}
                    />
                    <FormContainer id="register"
                                   classname="login register"
                                   config={registerConfig}
                                   title="注册账号-"
                    />
                    <FormContainer id="resetPassword"
                                   classname="login register"
                                   config={registerConfig}
                                   title="重置密码-"
                    />
                </React.Fragment>

            )
        }
    };

    ReactDOM.render(
        <Content/>,
        document.getElementById('content')
    );
</script>
</body>
</html>